angular.module("Transport",["ngRoute","ngSanitize","angular-md5","LocalStorageModule"]).config(["$routeProvider","$httpProvider","$locationProvider","localStorageServiceProvider","config",function(e,t,r,o,n){angular.forEach(n.interceptor,function(t){var r=t.replace(/_[a-z]/g,function(e){return e.split("_")[1].toUpperCase()});r+="Controller",e.when("/"+t,{templateUrl:"templates/"+t+".html",reloadOnSearch:!1,controller:r,resolve:{user:["$q","$location","localStorageService",function(e,r,o){var n=["account","me_info","address","create_address","cargo","cargos","cargos_merge","orders","services","charge_records","askforpay_records"],a=e.defer();return n.includes(t)&&!o.get("token")?(a.reject(),r.path("/signin").replace(),void 0):(a.resolve(),a.promise)}]}})}),e.otherwise("/index"),t.defaults.useXDomain=!0,t.defaults.withCredentials=!0,delete t.defaults.headers.common["X-Requested-With"],o.setStorageCookie(.02),t.interceptors.push("tokenInterceptor"),t.interceptors.push("timeoutHttpInterceptor")}]).run(["appServices",function(e){e.init()}]),angular.module("Transport").factory("userServices",["$http","localStorageService","config",function(e,t,r){return{signin:function(t){return e({url:r.url+"/mobile/UserCenter/Login",method:"GET",params:angular.extend({},r.common_params,t)}).then(function(e){return e.data})},signup:function(t){return e({url:r.url+"/mobile/UserCenter/doReg",method:"GET",params:angular.extend({},r.common_params,t)}).then(function(e){return e.data})},forget:function(t){return e({url:r.url+"/mobile/UserCenter/forgetPwdPost",method:"GET",params:angular.extend({},r.common_params,t)}).then(function(e){return e.data})},get_smscode_1:function(t){return e({url:r.url+"/mobile/UserCenter/sendCode",method:"GET",params:angular.extend({},r.common_params,t)}).then(function(e){return e.data})},get_smscode_2:function(t){return e({url:r.url+"/mobile/UserCenter/sendForgetCode",method:"GET",params:angular.extend({},r.common_params,t)}).then(function(e){return e.data})},query_userinfo:function(o){return e({url:r.url+"/mobile/UserCenter/userInfo",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},query_address:function(o){return e({url:r.url+"/mobile/UserCenter/addressList",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},remove_address:function(o){return e({url:r.url+"/mobile/UserCenter/deleteAddress",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},create_address:function(o){return e({url:r.url+"/mobile/UserCenter/addAddress",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},modify_userinfo:function(o){return e({url:r.url+"/mobile/UserCenter/updatePswOrEmail",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},charge:function(o){return e({url:r.url+"/mobile/ServerManage/addCharge",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},query_charge_records:function(o){return e({url:r.url+"/mobile/ServerManage/chargeList",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},askforpay:function(o){return e({url:r.url+"/mobile/ServerManage/addPay",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},query_askforpay_records:function(o){return e({url:r.url+"/mobile/ServerManage/payList",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},create_cargo:function(o){return e({url:r.url+"/mobile/CargoManage/addItemRegiste",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},query_cargos:function(o){return e({url:r.url+"/mobile/CargoManage/itemRegisterList",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},query_merge_cargos:function(o){return e({url:r.url+"/mobile/CargoManage/mergeCargo",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},merge_cargos:function(o){return e({url:r.url+"/mobile/CargoManage/addCargo",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},query_orders:function(o){return e({url:r.url+"/mobile/CargoManage/cargoList",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},bind_to_taobao:function(o){return e({url:r.url+"/mobile/CargoManage/updateOrderNo",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},query_transfer:function(o){return e({url:r.url+"/mobile/CargoManage/bankList",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})},query_sf_address:function(o){return e({url:r.url+"/mobile/CargoManage/getPickUpAddressList",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})}}}]),angular.module("Transport").factory("transportServices",["$http","localStorageService","config",function(e,t,r){return{query_contact:function(t){return e({url:r.url+"/mobile/Home/contactInfo",method:"GET",params:angular.extend({},r.common_params,t)}).then(function(e){return e.data})},query_banner:function(t){return e({url:r.url+"/mobile/Home/bannerList",method:"GET",params:angular.extend({},r.common_params,t)}).then(function(e){return e.data})},query_tutorial:function(t){return e({url:r.url+"/mobile/Home/teach",method:"GET",params:angular.extend({},r.common_params,t)}).then(function(e){return e.data})},query_fee:function(t){return e({url:r.url+"/mobile/Home/money",method:"GET",params:angular.extend({},r.common_params,t)}).then(function(e){return e.data})},query_calculator_constant:function(t){return e({url:r.url+"/mobile/Home/fee",method:"GET",params:angular.extend({},r.common_params,t)}).then(function(e){return e.data})},query_news:function(t){return e({url:r.url+"/mobile/Home/newsList",method:"GET",params:angular.extend({},r.common_params,t)}).then(function(e){return e.data})},query_news_by_id:function(t){return e({url:r.url+"/mobile/Home/newsDetail",method:"GET",params:angular.extend({},r.common_params,t)}).then(function(e){return e.data})},query_self_address:function(t){return e({url:r.url+"/mobile/CargoManage/getAddressList",method:"GET",params:angular.extend({},r.common_params,t)}).then(function(e){return e.data})},query_business_hour:function(t){return e({url:r.url+"/mobile/CargoManage/getTimeList",method:"GET",params:angular.extend({},r.common_params,t)}).then(function(e){return e.data})},query_payments:function(o){return e({url:r.url+"/mobile/CargoManage/getCargoPayTypeList",method:"GET",params:angular.extend({},r.common_params,{token:t.get("token")},o)}).then(function(e){return e.data})}}}]),angular.module("Transport").factory("tokenInterceptor",["$location","$q","localStorageService","md5Services","errorServices","config",function(e,t,r,o,n,a){return{request:function(e){if(e.url.indexOf(".html")>0)return e;var t=o.encrypt(e.params);return e.params.app_sign=t,e},requestError:function(){},response:function(o){var n=t.defer();return o.config.url.indexOf(".html")>0?o:o.data.code==a.request.TOKEN_INVALID?(console.log("TOKEN_INVALID"),r.remove("token"),e.path("/signin").replace(),n.promise):o},responseError:function(e){var r=t.defer();return n.requestError(e.data,e.status,e.headers,e.config),r.promise}}}]),angular.module("Transport").factory("toastServices",function(){return{show:function(){$(".toast").show()},hide:function(){$(".toast").hide()}}}),angular.module("Transport").factory("timeoutHttpInterceptor",["$location","$q","localStorageService","errorServices",function(e,t,r,o){return{request:function(e){return e.timeout=8e3,e},requestError:function(){},response:function(e){return e},responseError:function(e){var r=t.defer();return o.requestError(e.data,e.status,e.headers,e.config),r.promise}}}]),angular.module("Transport").factory("md5Services",["md5",function(e){return{encrypt:function(t){var r,o,n=[],a="2016lBiBiCargo!@#12310181112";return angular.forEach(t,function(e,t){n.push(t+"="+e)}),r=n.sort().join("&"),r=r+"&key="+a,o=e.createHash(r),o.toUpperCase()}}}]),angular.module("Transport").factory("errorServices",["$rootScope","$timeout","toastServices",function(e,t,r){return{show:function(t){console.log(t),e.error_message=t,$(".error-msg").show()},hide:function(){e.error_message="",$(".error-msg").hide()},autoHide:function(r){e.error_message=r,$(".error-msg").show(),t(function(){e.error_message="",$(".error-msg").hide()},3e3)},requestError:function(e,t,o,n){switch(r.hide(),t){case-1:case 0:this.autoHide("網絡連接超時,请重新加载！");break;case 500:case 501:case 502:case 503:case 504:case 505:case 506:case 507:case 509:case 510:this.autoHide("服務器連接出錯")}console.log("onRequestError output status, data, headers, config"),console.log(t),console.log(e),console.log(o),console.log(n),console.log("onRequestError end")}}}]),angular.module("Transport").factory("appServices",["$rootScope","$window","$location","errorServices","localStorageService","toastServices","config",function(e,t,r,o,n,a,s){var i=function(){},u=function(e,t,r){a.hide(),o.hide(),l(e,t,r)},c=function(){},l=function(){};return{init:function(){e.$on("$routeChangeStart",i),e.$on("$routeChangeSuccess",u),e.$on("$routeChangeError",c),e.go=function(e){r.path(e)},e.back=function(){t.history.back()},e.is_signin=function(){return n.get("token")?!0:!1},e.logout=function(){n.remove("token")},e.staticImageUrl=s.imageUrl}}}]),angular.module("Transport").directive("showOnLoaded",function(){return{link:function(e,t){$(t).css({visibility:"hidden"}),t.bind("load",function(){console.log("loaded");var r=parseFloat(e.$eval($(t).parent().attr("data-rate")));if(!r)return console.log("unexpect rate"),void 0;var o=$(t).width()/$(t).height();r>o?$(t).css({height:"100%",width:"auto"}):$(t).css({height:"auto",width:"100%"}),$(t).parent().css({background:"none"}),$(t).css({visibility:"visible"})})}}}),angular.module("Transport").directive("onRepeatDone",function(){return{restrict:"A",link:function(e,t){e.$last&&e.$emit("repeat_done",t)}}}),angular.module("Transport").directive("imageview",function(){return{restrict:"E",scope:{src:"="},template:"<img ng-src='{{src}}' show-on-loaded>",link:function(e,t){var r="../images/default.png",o=parseFloat(e.$eval($(t).attr("data-rate")));if(!o)return console.log("unexpect rate"),void 0;var n={display:"block",width:$(t).width()||$(t).parent().width(),overflow:"hidden","text-align":"center","background-image":"url("+r+")","background-size":"100%","background-position":"center center","line-height":($(t).width()||$(t).parent().width())/o+"px",height:($(t).width()||$(t).parent().width())/o};$(t).css(n),$(t).parent().css({overflow:"hidden"})}}}),angular.module("Transport").directive("dribehanceHeader",["$rootScope",function(e){return{restrict:"E",templateUrl:"templates/header.html",scope:{title:"="},link:function(t){t.back=function(){e.back()}}}}]),angular.module("Transport").directive("countdown",["$interval",function(e){return{restrict:"E",scope:{countdown:"=",disabled:"=countdownDisabled"},link:function(t,r){function o(){var r=t.countdown.message,o=parseFloat(t.countdown.count)?parseFloat(t.countdown.count):60;n=!0,t.$apply(function(){t.countdown.message=o--,t.countdown.mode="disabled",t.countdown.reset=!1,t.countdown.callback()});var a=e(function(){t.countdown.message=o--,(0>o||t.countdown.reset)&&(e.cancel(a),t.countdown.message=r,n=!1)},1e3)}var n=!1;$(r).bind("click",function(){t.disabled||n||o()})}}}]),angular.module("Transport").directive("banner",function(){return{restrict:"E",transclude:!0,template:"<div class='carousel-holder owl-carousel theme' ng-transclude></div>",link:function(e,t){var r={autoplay:!0,items:1};r=angular.extend({},r,e.$eval($(t).attr("data-options")));var o=parseFloat(e.$eval($(t).attr("data-rate"))),n={display:"block",width:$(t).parent().width()||$(window).width(),height:($(t).parent().width()||$(window).width())/o};$(t).css(n),e.$on("repeat_done",function(){$(t).find(".carousel-holder").owlCarousel(r)})}}}),angular.module("Transport").controller("transportScopeController",["$scope","errorServices","toastServices","localStorageService","config",function(){}]),angular.module("Transport").controller("tiaoyueController",["$scope","errorServices","toastServices","localStorageService","config",function(){}]),angular.module("Transport").controller("tiaokuanController",["$scope","errorServices","toastServices","localStorageService","config",function(){}]),angular.module("Transport").controller("teachingController",["$scope","transportServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a){o.show(),t.query_tutorial({}).then(function(t){o.hide(),t.code==a.request.SUCCESS&&t.status==a.response.SUCCESS?e.tutorial=t.teach:r.autoHide(t.message)})}]),angular.module("Transport").controller("signupController",["$scope","$location","userServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a,s){e.input={username:"",telephone:"",smscode:"",password:"",password_1:"",email:""},e.countdown={message:"獲取驗證碼"},e.countdown.callback=function(){n.show(),r.get_smscode_1({telephone:e.input.telephone}).then(function(e){n.hide(),e.code==s.request.SUCCESS&&e.status==s.response.SUCCESS?o.autoHide(e.message):o.autoHide(e.message)})},e.ajaxForm=function(){return e.input.password!=e.input.password_1?(o.autoHide("兩次輸入的密碼不一致"),void 0):(n.show(),r.signup({telephone:e.input.telephone,tel_code:e.input.smscode,email:e.input.email,password:e.input.password,nickname:e.input.username}).then(function(e){n.hide(),e.code==s.request.SUCCESS&&e.status==s.response.SUCCESS?(t.path("signin").replace(),o.autoHide(e.message)):o.autoHide(e.message)}),void 0)}}]),angular.module("Transport").controller("signinController",["$scope","$rootScope","$location","userServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a,s,i){t.is_signin()&&r.path("index").replace(),e.input={telephone:"",password:""},e.ajaxForm=function(){a.show(),o.signin({telephone:e.input.telephone,password:e.input.password}).then(function(e){a.hide(),e.code==i.request.SUCCESS&&e.status==i.response.SUCCESS?(s.set("token",e.token),r.path("index").replace()):n.autoHide(e.message)})}}]),angular.module("Transport").controller("servicesController",["$scope","transportServices","userServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a,s){e.services={state:"charge"},e.change=function(t){e.services.state=t},n.show(),t.query_calculator_constant().then(function(t){n.hide(),t.code==s.request.SUCCESS&&t.status==s.response.SUCCESS?e.rate=t.rateModel.rate:o.autoHide(t.message)}),e.charge={company:"Highway Technology Limited",type:"1",alipay:"",alipay_owner:"",rmb:"",hkd:""},e.$watch("charge.rmb",function(t,r){return t!=r&&""!=t&&void 0!=t?parseFloat(t)?(e.charge.hkd=new Number(t*e.rate).toFixed(2),void 0):(o.autoHide("請輸入數字"),void 0):void 0}),e.ajaxForm=function(){n.show(),r.charge({bank_type:"1",acount:e.charge.alipay,acount_name:e.charge.alipay_owner,need_from_money:e.charge.rmb,need_to_money:e.charge.hkd}).then(function(t){n.hide(),t.code==s.request.SUCCESS&&t.status==s.response.SUCCESS?(o.autoHide(t.message),e.charge={company:"Highway Technology Limited",type:"1",alipay:"",alipay_owner:"",rmb:"",hkd:""}):o.autoHide(t.message)})},e.askforpay={company:"Highway Technology Limited",type:"1",alipay:"",transcation_id:"",rmb:"",hkd:"0.00",fee:"0.00",total_hkd:"0.00"},e.$watch("askforpay.rmb",function(t,r){if(t!=r&&""!=t&&void 0!=t){if(!parseFloat(t))return o.autoHide("請輸入數字"),void 0;t=parseFloat(t),e.askforpay.hkd=new Number(t*e.rate).toFixed(2),e.askforpay.fee=new Number(.03*e.askforpay.hkd).toFixed(2),e.askforpay.total_hkd=new Number(1.03*e.askforpay.hkd).toFixed(2)}}),e.ajaxForm_1=function(){n.show(),r.askforpay({pay_bank_type:"1",pay_name:e.askforpay.alipay,pay_num:e.askforpay.transcation_id,pay_money_RMB:e.askforpay.rmb,money_HKD:e.askforpay.hkd,total_money_HKD:e.askforpay.total_hkd}).then(function(t){n.hide(),t.code==s.request.SUCCESS&&t.status==s.response.SUCCESS?(o.autoHide(t.message),e.askforpay={company:"Highway Technology Limited",type:"1",alipay:"",transcation_id:"",rmb:"",hkd:"0.00",fee:"0.00",total_hkd:"0.00"}):o.autoHide(t.message)})}}]),angular.module("Transport").controller("searchController",["$scope","$location","errorServices","toastServices","localStorageService","config",function(e,t,r){e.input={},e.ajaxForm=function(){var o=$("input[name='start'").val(),n=$("input[name='end'").val();return e.input.flow_id&&t.path("orders").search({start:o,end:n,flow_id:e.input.flow_id}),""==o||""==n?(r.autoHide("選擇時間"),void 0):(t.path("orders").search({start:o,end:n,flow_id:e.input.flow_id}),void 0)}}]),angular.module("Transport").controller("remarksController",["$scope","errorServices","toastServices","localStorageService","config",function(){}]),angular.module("Transport").controller("questionController",["$scope","errorServices","toastServices","localStorageService","config",function(){}]),angular.module("Transport").controller("privacyController",["$scope","errorServices","toastServices","localStorageService","config",function(){}]),angular.module("Transport").controller("paymentController",["$scope","$location","$routeParams","$rootScope","$timeout","userServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a,s,i,u,c){e.input={order_id:""},e.ajaxForm=function(){i.show(),a.bind_to_taobao({order_no:e.input.order_id,cargo_id:r.id}).then(function(e){i.hide(),e.code==c.request.SUCCESS&&e.status==c.response.SUCCESS?(s.autoHide(e.message),n(function(){t.path("orders").replace()},1e3)):s.autoHide(e.message)})},i.show(),a.query_transfer({}).then(function(t){i.hide(),t.code==c.request.SUCCESS&&t.status==c.response.SUCCESS?e.banks=t.Banks:s.autoHide(t.message)})}]),angular.module("Transport").controller("ordersController",["$scope","$routeParams","$location","userServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a,s,i){e.preview_id="",e.preview=function(t){e.preview_id=t},e.preview_hide=function(){e.preview_id=""},e.orders=[],e.page={pn:1,page_size:10,message:"点击加载更多",flow_number:t.flow_id,start_day:t.start,end_day:t.end},e.loadMore=function(){e.no_more||(a.show(),e.page.message="正在加载...",o.query_orders(e.page).then(function(t){a.hide(),e.page.message="点击加载更多",t.code==i.request.SUCCESS&&t.status==i.response.SUCCESS?(e.orders=e.orders.concat(t.Result.Cargos.list),e.no_more=e.orders.length==t.Result.Cargos.totalRow?!0:!1):n.autoHide("服务器错误"),e.no_more&&(e.page.message="加載完成，共"+e.orders.length+"件訂單"),e.page.pn++}))},e.loadMore(),e.get_server=function(e){return["自取","送貨上門"][e]},e.get_status=function(e){return["未處理","未付款","打包中","已發貨","已簽收"][e]},e.get_status_1=function(e){return["未收貨","已入倉","集運中","已配送完"][e]},e.payment=function(e){r.path("payment").search("id",e)}}]),angular.module("Transport").controller("orderController",["$scope","errorServices","toastServices","localStorageService","config",function(){}]),angular.module("Transport").controller("meInfoController",["$scope","$rootScope","$timeout","userServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a,s,i){a.show(),o.query_userinfo().then(function(e){a.hide(),e.code==i.request.SUCCESS&&e.status==i.response.SUCCESS?(t.user=e.Result.UserInfo,t.user.new_email=t.user.email):n.autoHide(e.message)}),e.ajaxForm=function(){return t.user.password_1!=t.user.password_2?(n.autoHide("兩次輸入的密碼不一致"),void 0):(a.show(),o.modify_userinfo({nickname:t.user.nickname,password:t.user.password_1,email:t.user.new_email}).then(function(e){a.hide(),e.code==i.request.SUCCESS&&e.status==i.response.SUCCESS?(n.autoHide(e.message),r(function(){t.back()},1e3)):n.autoHide(e.message)}),void 0)}}]),angular.module("Transport").controller("infosController",["$scope","transportServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a){e.news=[],e.page={pn:1,page_size:15,message:"点击加载更多"},e.loadMore=function(){e.no_more||(o.show(),e.page.message="正在加载...",t.query_news(e.page).then(function(t){o.hide(),e.page.message="点击加载更多",t.code==a.request.SUCCESS&&t.status==a.response.SUCCESS?(e.news=e.news.concat(t.Result.NewsList.list),e.no_more=e.news.length==t.Result.NewsList.totalRow?!0:!1):r.autoHide("服务器错误"),e.no_more&&(e.page.message="没有了"),e.page.pn++}))},e.format_time=function(e){return e.split(" ")[0]},e.loadMore()}]),angular.module("Transport").controller("infoController",["$scope","$routeParams","transportServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a,s){n.show(),r.query_news_by_id({id:t.id}).then(function(t){n.hide(),t.code==s.request.SUCCESS&&t.status==s.response.SUCCESS?e.info=t.Result.NewsDetail:o.autoHide(t.message)})}]),angular.module("Transport").controller("indexController",["$scope","$rootScope","userServices","transportServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a,s,i){a.show(),o.query_banner({}).then(function(t){a.hide(),t.code==i.request.SUCCESS&&t.status==i.response.SUCCESS?e.banners=t.IndexBanners:n.autoHide(t.message)}),a.show(),s.get("token")&&r.query_userinfo().then(function(e){a.hide(),e.code==i.request.SUCCESS&&e.status==i.response.SUCCESS?(t.user=e.Result.UserInfo,t.user.new_email=t.user.email):n.autoHide(e.message)})}]),angular.module("Transport").controller("forgetController",["$scope","$rootScope","$timeout","userServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a,s,i){e.input={telephone:"",smscode:""},e.countdown={message:"獲取驗證碼"},e.countdown.callback=function(){a.show(),o.get_smscode_2({telephone:e.input.telephone}).then(function(t){a.hide(),t.code==i.request.SUCCESS&&t.status==i.response.SUCCESS?n.autoHide(t.message):(e.countdown.reset=!0,n.autoHide(t.message))})},e.ajaxForm=function(){a.show(),o.forget({telephone:e.input.telephone,tel_code:e.input.smscode}).then(function(e){a.hide(),e.code==i.request.SUCCESS&&e.status==i.response.SUCCESS?(n.autoHide(e.message),r(function(){t.back()},1e3)):n.autoHide(e.message)})}}]),angular.module("Transport").controller("createAddressController",["$scope","$rootScope","$timeout","userServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a,s,i){e.input={username:"",telephone:"",provinces:["香港"],citys:["新界","九龍","香港島"],districts:{"新界":["葵青區","荃灣區","屯門區","元朗區","北區","大埔區","沙田區","西貢區","離島區"],"九龍":["油尖旺區","深水涉區","九龍城區","黃大仙區","觀塘區"],"香港島":["灣仔區","中西區","東區","南區"]},address:""},e.input.province=e.input.provinces[0],e.input.city=e.input.citys[0],e.$watch("input.city",function(t){e.input.districts_filter=e.input.districts[t],e.input.district=e.input.districts_filter[0]}),e.ajaxForm=function(){a.show(),o.create_address({link_name:e.input.username,link_telephone:e.input.telephone,SelProvince:e.input.province,SelCity:e.input.city,SelArea:e.input.district,address:e.input.address}).then(function(e){a.hide(),e.code==i.request.SUCCESS&&e.status==i.response.SUCCESS?(n.autoHide(e.message),r(function(){t.back()},1e3)):n.autoHide(e.message)})}}]),angular.module("Transport").controller("costController",["$scope","transportServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a){o.show(),t.query_fee({}).then(function(t){o.hide(),t.code==a.request.SUCCESS&&t.status==a.response.SUCCESS?e.fee=t.money:r.autoHide(t.message)})}]),angular.module("Transport").controller("contactController",["$scope","transportServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a){o.show(),t.query_contact({}).then(function(t){o.hide(),t.code==a.request.SUCCESS&&t.status==a.response.SUCCESS?e.contact=t.contactInfo:r.autoHide(t.message)})}]),angular.module("Transport").controller("chargeRecordsController",["$scope","userServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a){e.records=[],e.page={pn:1,page_size:10,message:"点击加载更多"},e.loadMore=function(){e.no_more||(o.show(),e.page.message="正在加载...",t.query_charge_records(e.page).then(function(t){o.hide(),e.page.message="点击加载更多",t.code==a.request.SUCCESS&&t.status==a.response.SUCCESS?(e.records=e.records.concat(t.Result.ChargeList.list),e.no_more=e.records.length==t.Result.ChargeList.totalRow?!0:!1):r.autoHide("服务器错误"),e.no_more&&(e.page.message="加載完成，共"+e.records.length+"條記錄"),e.page.pn++}))},e.get_status=function(e){return["删除","未審批","已完成"][e]},e.loadMore()}]),angular.module("Transport").controller("cargosMergeController",["$scope","$routeParams","transportServices","userServices","$location","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a,s,i,u){e.input={way:"self",address:"",address_type:"business",travel_address:"",payment:"",preview:"hide",business_hour:"",rmb:"",hkd:""},s.show(),o.query_merge_cargos({ids:t.ids}).then(function(t){s.hide(),t.code==u.request.SUCCESS&&t.status==u.response.SUCCESS?e.cargos=t.Result.MergeCargos:a.autoHide(t.message)}).then(function(){s.show(),r.query_calculator_constant().then(function(t){s.hide(),t.code==u.request.SUCCESS&&t.status==u.response.SUCCESS?(e.rate=t.rateModel.rate,e.fee=t.feeModel):a.autoHide(t.message)}).then(function(){e.calculate=function(){return"self"==e.input.way?(e.calculate_by_self(e.get_weight()),void 0):"travel"==e.input.way&&"business"==e.input.address_type?(e.calculate_by_business(e.get_weight()),void 0):"travel"==e.input.way&&"house"==e.input.address_type?(e.calculate_by_house(e.get_weight()),void 0):"SF"==e.input.way?(e.calculate_by_SF(e.get_weight()),void 0):void 0},e.calculate_by_self=function(t){s.show(),r.query_self_address({type:0}).then(function(t){s.hide(),t.code==u.request.SUCCESS&&t.status==u.response.SUCCESS?(e.addresses=t.AddressList,e.input.address=e.addresses[0],e.query_business_hour()):a.autoHide(t.message)}),e.input.rmb=parseFloat(t)<parseFloat(e.fee.lastget_kg)?e.fee.lastget_RMB:parseFloat(e.fee.firstget)+(Math.ceil(t)-1)*parseFloat(e.fee.lastget),e.input.hkd=(parseFloat(e.input.rmb)*parseFloat(e.rate)).toFixed(2)},e.calculate_by_business=function(t){e.input.rmb=parseFloat(t)<parseFloat(e.fee.lastsend_kg)?e.fee.lastsend_RMB:parseFloat(e.fee.firstsend)+(Math.ceil(t)-1)*parseFloat(e.fee.lastsend),e.input.hkd=(parseFloat(e.input.rmb)*parseFloat(e.rate)).toFixed(2)},e.calculate_by_house=function(t){e.input.rmb=parseFloat(t)<parseFloat(e.fee.lastsend_kg)?e.fee.lastsend_RMB:parseFloat(e.fee.firstsend)+(Math.ceil(t)-1)*parseFloat(e.fee.lastsend)+parseFloat(e.fee.additionalFee),e.input.hkd=(parseFloat(e.input.rmb)*parseFloat(e.rate)).toFixed(2)},e.calculate_by_SF=function(t){o.query_sf_address({weight:e.get_weight()}).then(function(t){t.code==u.request.SUCCESS&&t.status==u.response.SUCCESS?(e.addresses=t.PickUpAddressList,e.input.address=e.addresses[0],e.query_business_hour()):a.autoHide(t.message)}),e.input.rmb=parseFloat(t)<parseFloat(e.fee.lastsend_kg)?e.fee.lastsend_RMB:parseFloat(e.fee.firstsend)+(Math.ceil(t)-1)*parseFloat(e.fee.lastsend)+parseFloat(e.fee.additionalFee),e.input.hkd=(parseFloat(e.input.rmb)*parseFloat(e.rate)).toFixed(2)},e.$watch("input.way",function(){e.calculate(),e.payments=e.payments_1,e.input.payment=e.payments[0],e.business_hours=[{address_get:"",time_get:"星期一至五上午",type:0,post_time:"",status:1},{address_get:"",time_get:"星期一至五下午",type:0,post_time:"",status:1},{address_get:"",time_get:"星期六日上午",type:0,post_time:"",status:1},{address_get:"",time_get:"星期六日下午",type:0,post_time:"",status:1}],e.input.business_hour=e.business_hours[0]}),e.$watch("input.address_type",function(){e.calculate()})})}),e.get_status=function(e){return["未收貨","已入倉","集運中","貨物配送完成"][e]},e.cargos=[],e.get_weight=function(){var t=0;return angular.forEach(e.cargos,function(e){t+=parseFloat(e.kg)}),t.toFixed(2)},s.show(),r.query_self_address({type:0}).then(function(t){s.hide(),t.code==u.request.SUCCESS&&t.status==u.response.SUCCESS?(e.addresses=t.AddressList,e.input.address=e.addresses[0],e.query_business_hour()):a.autoHide(t.message)}),e.$watch("input.address",function(t,r){t!==r&&e.query_business_hour()}),e.query_business_hour=function(){var t=1;"SF"==e.input.way&&(t=2),r.query_business_hour({take_places:e.input.address.address_get,jiyuan_type:t}).then(function(t){s.hide(),t.code==u.request.SUCCESS&&t.status==u.response.SUCCESS?(e.business_hours=t.Result.TimeList,e.input.business_hour=e.business_hours[0]):a.autoHide(t.message)})},e.payments_1=[],e.payments_2=[],s.show(),r.query_payments().then(function(t){s.hide(),t.code==u.request.SUCCESS&&t.status==u.response.SUCCESS?(e.payments_1=t.payments,e.payments_2=angular.copy(t.payments),e.payments_2.unshift("貨到付款(只限自營自取點)")):a.autoHide(t.message)}),e.$watch("input.business_hour",function(t){e.payments="0"==t.type?e.payments_1:e.payments_2,e.input.payment=e.payments[0]}),e.travel_addresses=[],e.page={pn:1,page_size:100,message:"点击加载更多"},e.loadMore=function(){e.no_more||(s.show(),e.page.message="正在加载...",o.query_address(e.page).then(function(t){s.hide(),e.page.message="点击加载更多",t.code==u.request.SUCCESS&&t.status==u.response.SUCCESS?(e.travel_addresses=e.travel_addresses.concat(t.Result.AddressList.list),e.no_more=e.travel_addresses.length==t.Result.AddressList.totalRow?!0:!1,angular.forEach(e.travel_addresses,function(e){var t=e.link_name+"/"+e.link_telephone+"/"+e.province+"-"+e.city+"-"+e.country+"-"+e.address;e.long_address=t}),e.input.travel_address=e.travel_addresses[0]):a.autoHide("服务器错误"),e.no_more&&(e.page.message="没有了"),e.page.pn++}))},e.loadMore(),e.merge=function(){var r,i;"self"==e.input.way?(r=0,i=-1):r=1,"travel"==e.input.way&&"business"==e.input.address_type&&(i=0),"travel"==e.input.way&&"house"==e.input.address_type&&(i=1),"SF"==e.input.way&&(i=0),s.show(),o.merge_cargos({jiyunType:r,addressType:i,ids:t.ids,address:e.input.travel_address&&e.input.travel_address.long_address,take_places:e.input.address&&e.input.address.address_get,send_time_ziqu:e.input.business_hour&&(e.input.business_hour.time_get||e.input.business_hour.time),send_time_paisong:e.input.business_hour&&(e.input.business_hour.time_get||e.input.business_hour.time),pay_type:e.input.payment,weight:e.get_weight(),HKD:e.input.hkd,RMB:e.input.rmb,password:e.input.password}).then(function(t){s.hide(),t.code==u.request.SUCCESS&&t.status==u.response.SUCCESS?"self"==e.input.way?n.path("payment").search("id",t.cargo_id).replace():n.path("orders").replace():a.autoHide(t.message)})}}]),angular.module("Transport").controller("cargosController",["$scope","userServices","$location","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a,s){e.cargos=[],e.page={pn:1,page_size:10,message:"点击加载更多"},e.loadMore=function(){e.no_more||(n.show(),e.page.message="正在加载...",t.query_cargos(e.page).then(function(t){n.hide(),e.page.message="点击加载更多",t.code==s.request.SUCCESS&&t.status==s.response.SUCCESS?(e.cargos=e.cargos.concat(t.Result.ItemRegisters.list),e.no_more=e.cargos.length==t.Result.ItemRegisters.totalRow?!0:!1):o.autoHide("服务器错误"),e.no_more&&(e.page.message="加載完成，共"+e.cargos.length+"件貨物"),e.page.pn++}))},e.loadMore(),e.get_status=function(e){return["未收貨","已入倉","貨物配送完成"][e]},e.check=function(e){"0"!=e.item_type&&(e.checked=!e.checked)},e.check_reverse=function(){angular.forEach(e.cargos,function(e){"0"!=e.item_type&&(e.checked=!e.checked)})},e.merge=function(){var t="";angular.forEach(e.cargos,function(e){"0"!=e.item_type&&e.checked&&(t+=e.id+",")}),""!=t&&(t=t.substring(0,t.length-1),r.path("/cargos_merge").search("ids",t))
}}]),angular.module("Transport").controller("cargoController",["$scope","userServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a){e.input={number:"",company:"申通快遞",companys:["申通快遞","EMS郵政","順豐快遞","圓通快遞","中通快遞","韻達快遞","天天快遞","百世匯通","優速快遞","德邦物流","全峰快遞","信豐物流","國通快遞","快捷速遞","宅急送速遞","聯昊通快遞","其他"],tag:"",remarks:""},e.ajaxForm=function(){o.show(),t.create_cargo({express_number:e.input.number,express_company:e.input.company,item_content:e.input.tag,remarks:e.remarks}).then(function(t){o.hide(),t.code==a.request.SUCCESS&&t.status==a.response.SUCCESS?(r.autoHide(t.message),e.input.number="",e.input.tag="",e.input.remarks=""):r.autoHide(t.message)})}}]),angular.module("Transport").controller("calculatorController",["$scope","transportServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a){e.input={way:"self","long":"",wide:"",height:"",weight:""},o.show(),t.query_calculator_constant().then(function(t){o.hide(),t.code==a.request.SUCCESS&&t.status==a.response.SUCCESS?(e.rate=t.rateModel,e.fee=t.feeModel):r.autoHide(t.message)}),e.$watch("input.long",function(t,r){t!==r&&void 0!==t&&""!=t&&(e.input.cubic=(parseFloat(e.input.long)*parseFloat(e.input.wide)*parseFloat(e.input.height)/6e3).toFixed(2),"NaN"==e.input.cubic&&(e.input.cubic=0),e.input.weight=e.input.cubic)}),e.$watch("input.wide",function(t,r){t!==r&&void 0!==t&&""!=t&&(e.input.cubic=(parseFloat(e.input.long)*parseFloat(e.input.wide)*parseFloat(e.input.height)/6e3).toFixed(2),"NaN"==e.input.cubic&&(e.input.cubic=0),e.input.weight=e.input.cubic)}),e.$watch("input.height",function(t,r){t!==r&&void 0!==t&&""!=t&&(e.input.cubic=(parseFloat(e.input.long)*parseFloat(e.input.wide)*parseFloat(e.input.height)/6e3).toFixed(2),"NaN"==e.input.cubic&&(e.input.cubic=0),e.input.weight=e.input.cubic)}),e.$watch("input.weight",function(t,r){t!==r&&void 0!==t&&""!=t&&e.calculate()}),e.$watch("input.way",function(t,r){t!==r&&void 0!==t&&""!=t&&e.calculate()}),e.calculate=function(){return 0!=e.input.weight&&""!=e.input.weight&&void 0!=e.input.weight?"self"==e.input.way?(e.calculate_by_self(e.input.weight),void 0):"business"==e.input.way?(e.calculate_by_business(e.input.weight),void 0):"house"==e.input.way?(e.calculate_by_house(e.input.weight),void 0):void 0:void 0},e.calculate_by_self=function(t){e.input.rmb=t<e.fee.lastget_kg?e.fee.lastget_RMB:e.fee.firstget+(Math.ceil(t)-1)*e.fee.lastget,e.input.hkd=(e.input.rmb*e.rate.rate).toFixed(2)},e.calculate_by_business=function(t){e.input.rmb=t<e.fee.lastsend_kg?e.fee.lastsend_RMB:e.fee.firstsend+(Math.ceil(t)-1)*e.fee.lastsend,e.input.hkd=(e.input.rmb*e.rate.rate).toFixed(2)},e.calculate_by_house=function(t){e.input.rmb=t<e.fee.lastsend_kg?e.fee.lastsend_RMB:e.fee.firstsend+(Math.ceil(t)-1)*e.fee.lastsend+e.fee.additionalFee,e.input.hkd=(e.input.rmb*e.rate.rate).toFixed(2)}}]),angular.module("Transport").controller("askforpayRecordsController",["$scope","userServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a){e.records=[],e.page={pn:1,page_size:10,message:"点击加载更多"},e.loadMore=function(){e.no_more||(o.show(),e.page.message="正在加载...",t.query_askforpay_records(e.page).then(function(t){o.hide(),e.page.message="点击加载更多",t.code==a.request.SUCCESS&&t.status==a.response.SUCCESS?(e.records=e.records.concat(t.Result.PayList.list),e.no_more=e.records.length==t.Result.PayList.totalRow?!0:!1):r.autoHide("服务器错误"),e.no_more&&(e.page.message="加载完成，合计"+e.records.length+"条记录"),e.page.pn++}))},e.loadMore(),e.get_status=function(e){return["删除","未審批","已完成"][e]}}]),angular.module("Transport").controller("addressController",["$scope","$route","userServices","errorServices","toastServices","localStorageService","config",function(e,t,r,o,n,a,s){e.addresses=[],e.page={pn:1,page_size:10,message:"点击加载更多"},e.loadMore=function(){e.no_more||(n.show(),e.page.message="正在加载...",r.query_address(e.page).then(function(t){n.hide(),e.page.message="点击加载更多",t.code==s.request.SUCCESS&&t.status==s.response.SUCCESS?(e.addresses=e.addresses.concat(t.Result.AddressList.list),e.no_more=e.addresses.length==t.Result.AddressList.totalRow?!0:!1):o.autoHide("服务器错误"),e.no_more&&(e.page.message=""),e.page.pn++}))},e.loadMore(),e.open=function(t){e.remove_id=t,$.magnificPopup.open({items:{src:"#popup"},type:"inline"},0)},e.cancel=function(){$.magnificPopup.close()},e.confirm=function(){e.remove(e.remove_id),$.magnificPopup.close()},e.remove=function(e){n.show(),r.remove_address({id:e}).then(function(e){n.hide(),e.code==s.request.SUCCESS&&e.status==s.response.SUCCESS?(t.reload(),o.autoHide(e.message)):o.autoHide(e.message)})}}]),angular.module("Transport").controller("accountController",["$scope","errorServices","toastServices","localStorageService","config",function(){}]),angular.module("Transport").controller("aboutController",["$scope","errorServices","toastServices","localStorageService","config",function(){}]),angular.module("Transport").constant("config",{url:"http://120.76.41.192:8055",imageUrl:"http://120.76.41.192:8055/files/image?name=",request:{SUCCESS:"200",TOKEN_INVALID:"405"},response:{SUCCESS:1},common_params:{invoke:"h5"},interceptor:["about","account","address","askforpay_records","calculator","cargo","cargos","cargos_merge","charge_records","contact","cost","create_address","forget","index","info","infos","me_info","order","orders","privacy","payment","question","services","signin","signup","search","teaching","tiaokuan","remarks","transport_scope","tiaoyue"]});
//# sourceMappingURL=app.min.js.map
